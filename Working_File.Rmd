---
title: "Working_File"
author: "Zoe Wong"
date: "4/9/2021"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Setup

```{r setup}
getwd()
library(tidyverse)

survey.dat <- read.csv("./AquacultureSurveyData.csv")
survey.codes <- read.csv("./AquacultureSurveyCodes.csv")

# Set ggplot theme
mytheme <- theme_classic() +
  theme(axis.text = element_text(color = "black"), 
        legend.position = "top")
theme_set(mytheme)
```

## Basic overview questions

1. Make a dataframe just for species-related data - general analysis
      -> work w/ separate dataframes for each type of data (frequency, form, etc)?
      -> only use Tuna:Oysters since no category but frequency asks about raw forms
      -> omit Frequency_General - can analyze separately if necessary
2. Find frequency of each response
3. General overview questions:  
      *What are the most common species consumed?
      *Where do people get their seafood?  
      *How do people prefer to buy their seafood?
      *Do people prefer wild-caught or farmed seafood?

```{r frequency} 
freq.sp <- select(survey.dat, Frequency_Tuna:Frequency_Oysters)

freq.sp.Tuna <- as.data.frame(table(freq.sp$Frequency_Tuna))
freq.sp.Shrimp <- as.data.frame(table(freq.sp$Frequency_Shrimp))
freq.sp.Salmon <- as.data.frame(table(freq.sp$Frequency_Salmon))
freq.sp.Flounder <- as.data.frame(table(freq.sp$Frequency_Flounder))
freq.sp.BlueCrab <- as.data.frame(table(freq.sp$Frequency_BlueCrab))
freq.sp.Clams <- as.data.frame(table(freq.sp$Frequency_Clams))
freq.sp.Mullet <- as.data.frame(table(freq.sp$Frequency_Mullet))
freq.sp.Oysters <- as.data.frame(table(freq.sp$Frequency_Oysters))

freq.sp.summary <- freq.sp.Tuna %>% 
  left_join(freq.sp.Shrimp, by = "Var1") %>% 
  left_join(freq.sp.Salmon, by = "Var1") %>% 
  left_join(freq.sp.Flounder, by = "Var1") %>% 
  left_join(freq.sp.BlueCrab, by = "Var1") %>% 
  left_join(freq.sp.Clams, by = "Var1") %>% 
  left_join(freq.sp.Mullet, by = "Var1") %>% 
  left_join(freq.sp.Oysters, by = "Var1")
freq.sp.summary <- freq.sp.summary %>% 
  rename(Response = Var1,
         Tuna = Freq.x,
         Shrimp = Freq.y,
         Salmon = Freq.x.x,
         Flounder = Freq.y.y,
         BlueCrab = Freq.x.x.x,
         Clams = Freq.y.y.y,
         Mullet = Freq.x.x.x.x,
         Oysters = Freq.y.y.y.y)

freq.response.meaning <- c("Never", 
                           "Once in the past year", 
                           "A few times in the past year",
                           "Once a month",
                           "A few times every month",
                           "Once a week",
                           "A few times a week")

freq.sp.summary$Response_Explanation <- freq.response.meaning

ggplot(freq.sp.summary,aes(y=Response_Explanation, x=Tuna)) + 
  geom_point() + 
  labs(title ="In the past year, how often did you eat Tuna?",
       x="Count of Response Type",
       y="Response") + 
  theme(plot.title = element_text(hjust=0.5))
```

```{r where}
where.sp <- select(survey.dat, Where_Tuna:Where_Oysters)

where.sp.Tuna <- as.data.frame(table(where.sp$Where_Tuna))
where.sp.Shrimp <- as.data.frame(table(where.sp$Where_Shrimp))
where.sp.Salmon <- as.data.frame(table(where.sp$Where_Salmon))
where.sp.Flounder <- as.data.frame(table(where.sp$Where_Flounder))
where.sp.BlueCrab <- as.data.frame(table(where.sp$Where_BlueCrab))
where.sp.Clams <- as.data.frame(table(where.sp$Where_Clams))
where.sp.Mullet <- as.data.frame(table(where.sp$Where_Mullet))
where.sp.Oysters <- as.data.frame(table(where.sp$Where_Oysters))

where.sp.summary <- where.sp.Tuna %>% 
  left_join(where.sp.Shrimp, by = "Var1") %>% 
  left_join(where.sp.Salmon, by = "Var1") %>% 
  left_join(where.sp.Flounder, by = "Var1") %>% 
  left_join(where.sp.BlueCrab, by = "Var1") %>% 
  left_join(where.sp.Clams, by = "Var1") %>% 
  left_join(where.sp.Mullet, by = "Var1") %>% 
  left_join(where.sp.Oysters, by = "Var1")
where.sp.summary <- where.sp.summary %>% 
  rename(Response = Var1,
         Tuna = Freq.x,
         Shrimp = Freq.y,
         Salmon = Freq.x.x,
         Flounder = Freq.y.y,
         BlueCrab = Freq.x.x.x,
         Clams = Freq.y.y.y,
         Mullet = Freq.x.x.x.x,
         Oysters = Freq.y.y.y.y)

where.response.meaning <- c("Caught or grown myself", 
                           "Caught or grown by a friend or family member", 
                           "Grocery store",
                           "Restaurant",
                           "Seafood market",
                           "Commercial fisherman or seafood farmer",
                           "Community-supported fishery (CSF)",
                           "Other")

where.sp.summary$Response_Explanation <- where.response.meaning

ggplot(where.sp.summary,aes(y=Response_Explanation, x=Tuna)) + 
  geom_point() + 
  labs(title ="Tuna: Where do you get your seafood?",
       x="Count of Response Type",
       y="Response") + 
  theme(plot.title = element_text(hjust=0.5))
```

## Preference analysis

```{r preference}
pref.sp <- select(survey.dat, Preference_Tuna:Preference_Oysters)

pref.sp.Tuna <- as.data.frame(table(pref.sp$Preference_Tuna))
pref.sp.Shrimp <- as.data.frame(table(pref.sp$Preference_Shrimp))
pref.sp.Salmon <- as.data.frame(table(pref.sp$Preference_Salmon))
pref.sp.Flounder <- as.data.frame(table(pref.sp$Preference_Flounder))
pref.sp.BlueCrab <- as.data.frame(table(pref.sp$Preference_BlueCrab))
pref.sp.Clams <- as.data.frame(table(pref.sp$Preference_Clams))
pref.sp.Mullet <- as.data.frame(table(pref.sp$Preference_Mullet))
pref.sp.Oysters <- as.data.frame(table(pref.sp$Preference_Oysters))

pref.sp.summary <- pref.sp.Tuna %>% 
  left_join(pref.sp.Shrimp, by = "Var1") %>% 
  left_join(pref.sp.Salmon, by = "Var1") %>% 
  left_join(pref.sp.Flounder, by = "Var1") %>% 
  left_join(pref.sp.BlueCrab, by = "Var1") %>% 
  left_join(pref.sp.Clams, by = "Var1") %>% 
  left_join(pref.sp.Mullet, by = "Var1") %>% 
  left_join(pref.sp.Oysters, by = "Var1")
pref.sp.summary <- pref.sp.summary %>% 
  rename(Response = Var1,
         Tuna = Freq.x,
         Shrimp = Freq.y,
         Salmon = Freq.x.x,
         Flounder = Freq.y.y,
         BlueCrab = Freq.x.x.x,
         Clams = Freq.y.y.y,
         Mullet = Freq.x.x.x.x,
         Oysters = Freq.y.y.y.y)

pref.response.meaning <- c("Strongly prefer wild caught", 
                           "Slightly prefer wild caught", 
                           "No preference",
                           "Slightly prefer farmed",
                           "Strongly prefer farmed",
                           "I don't know")

pref.sp.summary$Response_Explanation <- pref.response.meaning

ggplot(pref.sp.summary,aes(y=Response_Explanation, x=Tuna)) + 
  geom_point() + 
  labs(title ="Do you prefer wild caught or farmed Tuna?",
       x="Count of Response Type",
       y="Response") + 
  theme(plot.title = element_text(hjust=0.5))
```

## Qualities analysis 

```{r qualities}
qual.sp <- select(survey.dat, Qualities_Healthy:Qualities_Fresh)

qual.sp.Healthy <- as.data.frame(table(qual.sp$Qualities_Healthy))
qual.sp.Local <- as.data.frame(table(qual.sp$Qualities_Local))
qual.sp.Safe <- as.data.frame(table(qual.sp$Qualities_Safe))
qual.sp.Local_Economies <- as.data.frame(table(qual.sp$Qualities_Local_Economies))
qual.sp.Tasty <- as.data.frame(table(qual.sp$Qualities_Tasty))
qual.sp.Affordable <- as.data.frame(table(qual.sp$Qualities_Affordable))
qual.sp.Local_Culture <- as.data.frame(table(qual.sp$Qualities_Local_Culture))
qual.sp.Sustainable <- as.data.frame(table(qual.sp$Qualities_Sustainable))
qual.sp.Easy_Access <- as.data.frame(table(qual.sp$Qualities_Easy_Access))
qual.sp.Local_Environments <- as.data.frame(table(qual.sp$Qualities_Local_Environments))
qual.sp.Fresh <- as.data.frame(table(qual.sp$Qualities_Fresh))

qual.sp.summary <- qual.sp.Healthy %>% 
  left_join(qual.sp.Local, by = "Var1") %>% 
  left_join(qual.sp.Safe, by = "Var1") %>% 
  left_join(qual.sp.Local_Economies, by = "Var1") %>% 
  left_join(qual.sp.Tasty, by = "Var1") %>% 
  left_join(qual.sp.Affordable, by = "Var1") %>% 
  left_join(qual.sp.Local_Culture, by = "Var1") %>% 
  left_join(qual.sp.Sustainable, by = "Var1") %>%
  left_join(qual.sp.Easy_Access, by = "Var1") %>%
  left_join(qual.sp.Local_Environments, by = "Var1") %>%
  left_join(qual.sp.Fresh, by = "Var1")
qual.sp.summary <- qual.sp.summary %>% 
  rename(Response = Var1,
         Healthy = Freq.x,
         Local = Freq.y,
         Safe = Freq.x.x,
         LocalEconomies = Freq.y.y,
         Tasty = Freq.x.x.x,
         Affordable = Freq.y.y.y,
         LocalCulture = Freq.x.x.x.x,
         Sustainable = Freq.y.y.y.y,
         EasyAccess = Freq.x.x.x.x.x,
         LocalEnvironments = Freq.y.y.y.y.y,
         Fresh = Freq)

qual.response.meaning <- c("More associated with wild caught", 
                           "Equally associated w/ wild caught & farmed", 
                           "More associated with farmed",
                           "Associated w/ neither wild caught nor farmed",
                           "I don't know")

qual.sp.summary$Response_Explanation <- qual.response.meaning

ggplot(qual.sp.summary,aes(y=Response_Explanation, x=Healthy)) + 
  geom_point() + 
  labs(title ="How do you associate healthy with different seafood types?",
       x="Count of Response Type",
       y="Response") + 
  theme(plot.title = element_text(hjust=0.5))
```

```{r better plotting practice 2}

#load necessary libraries
library(ggplot2)
library(reshape2)

#melt data frame into long format
qual.sp.summary.long <- melt(qual.sp.summary,  id.vars = 'Response_Explanation', variable.name = 'series')
qual.sp.summary.long <- qual.sp.summary.long[-c(1, 2, 3, 4, 5), ]
qual.sp.summary.long$value <- as.numeric(qual.sp.summary.long$value)

#create line plot for each column in data frame
ggplot(qual.sp.summary.long, aes(y=Response_Explanation, x=value)) +
  geom_point(aes(colour = series)) + 
  labs(title ="Quality associations with different seafood types",
       x="Count of Response Type",
       y="Response") + 
  theme(axis.text.x = element_text(angle = 90), 
        plot.title = element_text(hjust=0.5))
```
