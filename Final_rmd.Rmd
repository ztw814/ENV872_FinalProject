---
output: 
  pdf_document:
    keep_tex: yes
    fig_caption: yes
    number_sections: yes
geometry: margin=2.54cm
title: "Insert title of project here"
subtitle: "Web address for GitHub repository"
author: "Zoe Wong, Molly Bruce"
fontsize: 12pt
mainfont: Times New Roman

---

\newpage
\tableofcontents 
\newpage
\listoftables 
\newpage
\listoffigures 
\newpage

```{r setup, include=FALSE}
# Set global options for R chunks
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)

# Set your working directory

# Load your packages
library(tidyverse)
library(ggplot2)
library(reshape2)
library(cowplot)

# Set your ggplot theme
mytheme <- theme_light() +
  theme(axis.text = element_text(color = "black"), 
        legend.position = "top",
        plot.title = element_text(hjust=0.4))
theme_set(mytheme)

# Load your datasets
survey.dat <- read.csv("./Data/Raw/AquacultureSurveyData.csv")

```


# Rationale and Research Questions



## Research Questions

1. When consumers buy seafood, which species do they prefer?  Do they prefer wild or farmed fish?
2. What qualities do consumers associate with seafood?  What qualities do they value in seafood?
3. Are seafood values predicted by demographic variables such as age or education level?


\newpage

# Dataset Information

## Description of the Data

Our data were obtained from a social science survey conducted by a multi-university team of researchers, including the Murray lab at Duke University. The survey was conducted in the summer of 2020 via Qualtrics and targeted North Carolina residents from across the state.  

The survey asked respondents a total of 37 questions.  The question topics can be broken down into the following categories: eating habits for 8 types of seafood, what qualities respondents associate with seafood, attitudes about mariculture, attitudes about North Carolina seafood versus commercial fishing, respondents' involvement with seafood production, and demographic indicators. This study focuses on questions about eating habits, what qualities are associated with seafood, and demographic indicators.

Respondents answered each question by selecting one option from a menu of choices; the number of choices available depended on the question. The dataset contained responses from 1436 participants.

## Data Wrangling

For each analysis, we created a new dataset containing only the relevant columns.  For each category within the survey question, we then created a table with the frequency of each questions response.  For example, one question asked respondents to rate how often they ate each of 8 types of seafood; respondents could choose from 7 responses for each seafood type.  To wrangle this data, we created a dataframe for each type of seafood, for a total of 8 dataframes, each of which contained a column with the response choices and a column with the number of respondents that chose each response.  Because the response choices were only represented by a number in the raw data, we renamed the response column with the meaning of each number for greater clarity.  We repeated this process for the first two research questions (how often participants eat each type of seafood, whether participants prefer each type wild or farmed, whether participants associate each quality with wild or farmed seafood).

For the fourth research question, we created a dataframe with responses to a question about how important each of 11 qualities was when respondents were buying seafood.  We then renamed the columns and removed rows with alternate responses to demographic variables, such as "prefer not to answer."

## Data Structure




\newpage

# Exploratory Analysis 

- frequency general?
- map of counties where respondents live?



\newpage

# Analysis



## Question 1: When consumers buy seafood, which species do they prefer? 

```{r frequency}
# Selecting the relevant columns from the raw data frame
freq.sp <- select(survey.dat, Frequency_Tuna:Frequency_Oysters)

# Frequency of each response per seafood type
freq.sp.Tuna <- as.data.frame(table(freq.sp$Frequency_Tuna))
freq.sp.Shrimp <- as.data.frame(table(freq.sp$Frequency_Shrimp))
freq.sp.Salmon <- as.data.frame(table(freq.sp$Frequency_Salmon))
freq.sp.Flounder <- as.data.frame(table(freq.sp$Frequency_Flounder))
freq.sp.BlueCrab <- as.data.frame(table(freq.sp$Frequency_BlueCrab))
freq.sp.Clams <- as.data.frame(table(freq.sp$Frequency_Clams))
freq.sp.Mullet <- as.data.frame(table(freq.sp$Frequency_Mullet))
freq.sp.Oysters <- as.data.frame(table(freq.sp$Frequency_Oysters))

# Renaming Response column
freq.response.meaning <- c("1 Never", 
                           "2 Once in the past year", 
                           "3 A few times in the past year",
                           "4 Once a month",
                           "5 A few times every month",
                           "6 Once a week",
                           "7 A few times a week")

freq.sp.Tuna$Var1 <- freq.response.meaning
freq.sp.Shrimp$Var1 <- freq.response.meaning
freq.sp.Salmon$Var1 <- freq.response.meaning
freq.sp.Flounder$Var1 <- freq.response.meaning
freq.sp.BlueCrab$Var1 <- freq.response.meaning
freq.sp.Clams$Var1 <- freq.response.meaning
freq.sp.Mullet$Var1 <- freq.response.meaning
freq.sp.Oysters$Var1 <- freq.response.meaning

# Creating bar plots for each seafood type with consistent axes
freq.Tuna.bar <- ggplot(freq.sp.Tuna, aes(y = Var1, x = Freq)) +
  geom_bar(stat = "identity") +
  labs(y = "Response", x = "Count", title = "Tuna") + 
  scale_x_continuous(limits = c(0, 1200), breaks = c(0, 200, 400, 600, 800, 1000, 1200))

freq.Shrimp.bar <- ggplot(freq.sp.Shrimp, aes(y = Var1, x = Freq)) +
  geom_bar(stat = "identity") +
  labs(y = "Response", x = "Count", title = "Shrimp") + 
  scale_x_continuous(limits = c(0, 1200), breaks = c(0, 200, 400, 600, 800, 1000, 1200))

freq.Salmon.bar <- ggplot(freq.sp.Salmon, aes(y = Var1, x = Freq)) +
  geom_bar(stat = "identity") +
  labs(y = "Response", x = "Count", title = "Salmon") + 
  scale_x_continuous(limits = c(0, 1200), breaks = c(0, 200, 400, 600, 800, 1000, 1200))

freq.Flounder.bar <- ggplot(freq.sp.Flounder, aes(y = Var1, x = Freq)) +
  geom_bar(stat = "identity") +
  labs(y = "Response", x = "Count", title = "Flounder") + 
  scale_x_continuous(limits = c(0, 1200), breaks = c(0, 200, 400, 600, 800, 1000, 1200))

freq.BlueCrab.bar <- ggplot(freq.sp.BlueCrab, aes(y = Var1, x = Freq)) +
  geom_bar(stat = "identity") +
  labs(y = "Response", x = "Count", title = "Blue Crab") + 
  scale_x_continuous(limits = c(0, 1200), breaks = c(0, 200, 400, 600, 800, 1000, 1200))

freq.Clams.bar <- ggplot(freq.sp.Clams, aes(y = Var1, x = Freq)) +
  geom_bar(stat = "identity") +
  labs(y = "Response", x = "Count", title = "Clams") + 
  scale_x_continuous(limits = c(0, 1200), breaks = c(0, 200, 400, 600, 800, 1000, 1200))

freq.Mullet.bar <- ggplot(freq.sp.Mullet, aes(y = Var1, x = Freq)) +
  geom_bar(stat = "identity") +
  labs(y = "Response", x = "Count", title = "Mullet") + 
  scale_x_continuous(limits = c(0, 1200), breaks = c(0, 200, 400, 600, 800, 1000, 1200))

freq.Oysters.bar <- ggplot(freq.sp.Oysters, aes(y = Var1, x = Freq)) +
  geom_bar(stat = "identity") +
  labs(y = "Response", x = "Count", title = "Oysters") + 
  scale_x_continuous(limits = c(0, 1200), breaks = c(0, 200, 400, 600, 800, 1000, 1200))

# 4x2 plot presentation
plot_grid(freq.Tuna.bar, freq.Shrimp.bar, freq.Salmon.bar, freq.Flounder.bar, freq.BlueCrab.bar, freq.Clams.bar, freq.Mullet.bar, freq.Oysters.bar, ncol = 2)

```

[explanation of frequency findings. also add fig.cap above]






### Question 1a: Do consumers prefer wild or farmed fish?

```{r preference}
# Selecting the relevant columns from the raw data frame
pref.sp <- select(survey.dat, Preference_Tuna:Preference_Oysters)

# Frequency of each response per seafood type
pref.sp.Tuna <- as.data.frame(table(pref.sp$Preference_Tuna))
pref.sp.Shrimp <- as.data.frame(table(pref.sp$Preference_Shrimp))
pref.sp.Salmon <- as.data.frame(table(pref.sp$Preference_Salmon))
pref.sp.Flounder <- as.data.frame(table(pref.sp$Preference_Flounder))
pref.sp.BlueCrab <- as.data.frame(table(pref.sp$Preference_BlueCrab))
pref.sp.Clams <- as.data.frame(table(pref.sp$Preference_Clams))
pref.sp.Mullet <- as.data.frame(table(pref.sp$Preference_Mullet))
pref.sp.Oysters <- as.data.frame(table(pref.sp$Preference_Oysters))

# Renaming Response column and removing option 6 "I don't know"
pref.response.meaning <- c("5 Strongly prefer wild caught", 
                           "4 Slightly prefer wild caught", 
                           "3 No preference",
                           "2 Slightly prefer farmed",
                           "1 Strongly prefer farmed")

pref.sp.Tuna <- pref.sp.Tuna[-c(6),]
pref.sp.Tuna$Var1 <- pref.response.meaning
pref.sp.Shrimp <- pref.sp.Shrimp[-c(6),]
pref.sp.Shrimp$Var1 <- pref.response.meaning
pref.sp.Salmon <- pref.sp.Salmon[-c(6),]
pref.sp.Salmon$Var1 <- pref.response.meaning
pref.sp.Flounder <- pref.sp.Flounder[-c(6),]
pref.sp.Flounder$Var1 <- pref.response.meaning
pref.sp.BlueCrab <- pref.sp.BlueCrab[-c(6),]
pref.sp.BlueCrab$Var1 <- pref.response.meaning
pref.sp.Clams <- pref.sp.Clams[-c(6),]
pref.sp.Clams$Var1 <- pref.response.meaning
pref.sp.Mullet <- pref.sp.Mullet[-c(6),]
pref.sp.Mullet$Var1 <- pref.response.meaning
pref.sp.Oysters <- pref.sp.Oysters[-c(6),]
pref.sp.Oysters$Var1 <- pref.response.meaning

# Creating bar plots for each seafood type with consistent axes
pref.Tuna.bar <- ggplot(pref.sp.Tuna, aes(y = Var1, x = Freq)) +
  geom_bar(stat = "identity") +
  labs(y = "Response", x = "Count", title = "Tuna") + 
  scale_x_continuous(limits = c(0, 700), breaks = c(0, 200, 400, 600))

pref.Shrimp.bar <- ggplot(pref.sp.Shrimp, aes(y = Var1, x = Freq)) +
  geom_bar(stat = "identity") +
  labs(y = "Response", x = "Count", title = "Shrimp") + 
  scale_x_continuous(limits = c(0, 700), breaks = c(0, 200, 400, 600))

pref.Salmon.bar <- ggplot(pref.sp.Salmon, aes(y = Var1, x = Freq)) +
  geom_bar(stat = "identity") +
  labs(y = "Response", x = "Count", title = "Salmon") + 
  scale_x_continuous(limits = c(0, 700), breaks = c(0, 200, 400, 600))

pref.Flounder.bar <- ggplot(pref.sp.Flounder, aes(y = Var1, x = Freq)) +
  geom_bar(stat = "identity") +
  labs(y = "Response", x = "Count", title = "Flounder") + 
  scale_x_continuous(limits = c(0, 700), breaks = c(0, 200, 400, 600))

pref.BlueCrab.bar <- ggplot(pref.sp.BlueCrab, aes(y = Var1, x = Freq)) +
  geom_bar(stat = "identity") +
  labs(y = "Response", x = "Count", title = "Blue Crab") + 
  scale_x_continuous(limits = c(0, 700), breaks = c(0, 200, 400, 600))

pref.Clams.bar <- ggplot(pref.sp.Clams, aes(y = Var1, x = Freq)) +
  geom_bar(stat = "identity") +
  labs(y = "Response", x = "Count", title = "Clams") + 
  scale_x_continuous(limits = c(0, 700), breaks = c(0, 200, 400, 600))

pref.Mullet.bar <- ggplot(pref.sp.Mullet, aes(y = Var1, x = Freq)) +
  geom_bar(stat = "identity") +
  labs(y = "Response", x = "Count", title = "Mullet") + 
  scale_x_continuous(limits = c(0, 700), breaks = c(0, 200, 400, 600))

pref.Oysters.bar <- ggplot(pref.sp.Oysters, aes(y = Var1, x = Freq)) +
  geom_bar(stat = "identity") +
  labs(y = "Response", x = "Count", title = "Oysters") + 
  scale_x_continuous(limits = c(0, 700), breaks = c(0, 200, 400, 600))

# 4x2 plot presentation
plot_grid(pref.Tuna.bar, pref.Shrimp.bar, pref.Salmon.bar, pref.Flounder.bar, pref.BlueCrab.bar, pref.Clams.bar, pref.Mullet.bar, pref.Oysters.bar, ncol = 2)
```

[explanation of findings. also add fig.cap above]







## Question 2: What qualities do consumers associate with seafood?  What qualities do they value in seafood?

```{r qualities}
# Selecting the relevant columns from the raw data frame
qual.sp <- select(survey.dat, Qualities_Healthy:Qualities_Fresh)

# Frequency of each response per quality
qual.sp.Healthy <- as.data.frame(table(qual.sp$Qualities_Healthy))
qual.sp.Local <- as.data.frame(table(qual.sp$Qualities_Local))
qual.sp.Safe <- as.data.frame(table(qual.sp$Qualities_Safe))
qual.sp.Local_Economies <- as.data.frame(table(qual.sp$Qualities_Local_Economies))
qual.sp.Tasty <- as.data.frame(table(qual.sp$Qualities_Tasty))
qual.sp.Affordable <- as.data.frame(table(qual.sp$Qualities_Affordable))
qual.sp.Local_Culture <- as.data.frame(table(qual.sp$Qualities_Local_Culture))
qual.sp.Sustainable <- as.data.frame(table(qual.sp$Qualities_Sustainable))
qual.sp.Easy_Access <- as.data.frame(table(qual.sp$Qualities_Easy_Access))
qual.sp.Local_Environments <- as.data.frame(table(qual.sp$Qualities_Local_Environments))
qual.sp.Fresh <- as.data.frame(table(qual.sp$Qualities_Fresh))

# Renaming Response column and removing option 5 "I don't know"
qual.response.meaning <- c("4 More associated with wild caught", 
                           "3 Equally associated w/ wild caught & farmed", 
                           "2 More associated with farmed",
                           "1 Associated w/ neither wild caught nor farmed")

qual.sp.Healthy <- qual.sp.Healthy[-c(5),]
qual.sp.Healthy$Var1 <- qual.response.meaning
qual.sp.Local <- qual.sp.Local[-c(5),]
qual.sp.Local$Var1 <- qual.response.meaning
qual.sp.Safe <- qual.sp.Safe[-c(5),]
qual.sp.Safe$Var1 <- qual.response.meaning
qual.sp.Local_Economies <- qual.sp.Local_Economies[-c(5),]
qual.sp.Local_Economies$Var1 <- qual.response.meaning
qual.sp.Tasty <- qual.sp.Tasty[-c(5),]
qual.sp.Tasty$Var1 <- qual.response.meaning
qual.sp.Affordable <- qual.sp.Affordable[-c(5),]
qual.sp.Affordable$Var1 <- qual.response.meaning
qual.sp.Local_Culture <- qual.sp.Local_Culture[-c(5),]
qual.sp.Local_Culture$Var1 <- qual.response.meaning
qual.sp.Sustainable <- qual.sp.Sustainable[-c(5),]
qual.sp.Sustainable$Var1 <- qual.response.meaning
qual.sp.Easy_Access <- qual.sp.Easy_Access[-c(5),]
qual.sp.Easy_Access$Var1 <- qual.response.meaning
qual.sp.Local_Environments <- qual.sp.Local_Environments[-c(5),]
qual.sp.Local_Environments$Var1 <- qual.response.meaning
qual.sp.Fresh <- qual.sp.Fresh[-c(5),]
qual.sp.Fresh$Var1 <- qual.response.meaning

# Creating bar plots for each quality with consistent axes
qual.Healthy.bar <- ggplot(qual.sp.Healthy, aes(y = Var1, x = Freq)) +
  geom_bar(stat = "identity") +
  labs(y = "Response", x = "Count", title = "Healthy") + 
  scale_x_continuous(limits = c(0, 800), breaks = c(0, 200, 400, 600, 800))

qual.Local.bar <- ggplot(qual.sp.Local, aes(y = Var1, x = Freq)) +
  geom_bar(stat = "identity") +
  labs(y = "Response", x = "Count", title = "Local") + 
  scale_x_continuous(limits = c(0, 800), breaks = c(0, 200, 400, 600, 800))

qual.Safe.bar <- ggplot(qual.sp.Safe, aes(y = Var1, x = Freq)) +
  geom_bar(stat = "identity") +
  labs(y = "Response", x = "Count", title = "Safe") + 
  scale_x_continuous(limits = c(0, 800), breaks = c(0, 200, 400, 600, 800))

qual.Local_Economies.bar <- ggplot(qual.sp.Local_Economies, aes(y = Var1, x = Freq)) +
  geom_bar(stat = "identity") +
  labs(y = "Response", x = "Count", title = "Local Economies") + 
  scale_x_continuous(limits = c(0, 800), breaks = c(0, 200, 400, 600, 800))

qual.Tasty.bar <- ggplot(qual.sp.Tasty, aes(y = Var1, x = Freq)) +
  geom_bar(stat = "identity") +
  labs(y = "Response", x = "Count", title = "Tasty") + 
  scale_x_continuous(limits = c(0, 800), breaks = c(0, 200, 400, 600, 800))

qual.Affordable.bar <- ggplot(qual.sp.Affordable, aes(y = Var1, x = Freq)) +
  geom_bar(stat = "identity") +
  labs(y = "Response", x = "Count", title = "Affordable") + 
  scale_x_continuous(limits = c(0, 800), breaks = c(0, 200, 400, 600, 800))

qual.Local_Culture.bar <- ggplot(qual.sp.Local_Culture, aes(y = Var1, x = Freq)) +
  geom_bar(stat = "identity") +
  labs(y = "Response", x = "Count", title = "Local Culture") + 
  scale_x_continuous(limits = c(0, 800), breaks = c(0, 200, 400, 600, 800))

qual.Sustainable.bar <- ggplot(qual.sp.Sustainable, aes(y = Var1, x = Freq)) +
  geom_bar(stat = "identity") +
  labs(y = "Response", x = "Count", title = "Sustainable") + 
  scale_x_continuous(limits = c(0, 800), breaks = c(0, 200, 400, 600, 800))

qual.Easy_Access.bar <- ggplot(qual.sp.Easy_Access, aes(y = Var1, x = Freq)) +
  geom_bar(stat = "identity") +
  labs(y = "Response", x = "Count", title = "Easy Access") + 
  scale_x_continuous(limits = c(0, 800), breaks = c(0, 200, 400, 600, 800))

qual.Local_Environments.bar <- ggplot(qual.sp.Local_Environments, aes(y = Var1, x = Freq)) +
  geom_bar(stat = "identity") +
  labs(y = "Response", x = "Count", title = "Local Environments") + 
  scale_x_continuous(limits = c(0, 800), breaks = c(0, 200, 400, 600, 800))

qual.Fresh.bar <- ggplot(qual.sp.Fresh, aes(y = Var1, x = Freq)) +
  geom_bar(stat = "identity") +
  labs(y = "Response", x = "Count", title = "Fresh") + 
  scale_x_continuous(limits = c(0, 800), breaks = c(0, 200, 400, 600, 800))

# 6x2 plot presentation
plot_grid(qual.Tasty.bar, qual.Fresh.bar, qual.Healthy.bar, qual.Safe.bar, qual.Sustainable.bar, qual.Affordable.bar, qual.Easy_Access.bar, qual.Local.bar, qual.Local_Culture.bar, qual.Local_Economies.bar, qual.Local_Environments.bar, ncol = 2)
```

[explanation of findings. also add fig.cap above]







## Question 3: Are seafood values predicted by demographic variables such as age or education level?




\newpage

# Summary and Conclusions


\newpage

# References
<add references here if relevant, otherwise delete this section> 